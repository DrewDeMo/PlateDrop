---
import BaseLayout from '@layouts/BaseLayout.astro';
import HeroSection from '@components/home/HeroSection.astro';
import TrustSection from '@components/home/TrustSection.astro';
import ProcessSection from '@components/home/ProcessSection.astro';
import DealsSection from '@components/home/DealsSection.astro';
import FeaturesSection from '@components/home/FeaturesSection.astro';
import CategoriesSection from '@components/home/CategoriesSection.astro';
import ValuePropsSection from '@components/home/ValuePropsSection.astro';
import CtaSection from '@components/home/CtaSection.astro';
import { buildItemListSchema, loadHomepageDeals } from '@utils/deals';

const { deals, generatedAt } = await loadHomepageDeals(6);

const displayDate = generatedAt ? new Date(generatedAt) : new Date();
const formattedDate = displayDate.toLocaleDateString('en-US', {
  weekday: 'long',
  year: 'numeric',
  month: 'long',
  day: 'numeric'
});

const itemListSchema = buildItemListSchema(deals);
---

<BaseLayout
  title="Today's Home Gym Deals"
  description="Daily curated deals on home gym equipment including power racks, barbells, dumbbells, and cardio machines. Save on quality fitness gear."
  schemaType="ItemList"
  structuredData={itemListSchema}
>
  <HeroSection formattedDate={formattedDate} />
  <TrustSection />
  <ProcessSection />
  <DealsSection deals={deals} />
  <FeaturesSection />
  <CategoriesSection />
  <ValuePropsSection />
  <CtaSection />
</BaseLayout>
