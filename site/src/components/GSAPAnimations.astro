---
// GSAP Animations Component
---

<script>
  // Immediate console log for debugging
  console.log('[GSAP] Script loaded at:', new Date().toISOString());
  
  // Wait for DOM to be ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initAnimations);
  } else {
    // DOM already loaded
    initAnimations();
  }
  
  function initAnimations() {
    console.log('[GSAP] DOM ready, initializing animations...');
    
    // Dynamically import GSAP
    import('gsap').then(({ gsap }) => {
      console.log('[GSAP] ✅ GSAP loaded:', gsap.version);
      
      import('gsap/ScrollTrigger').then(({ ScrollTrigger }) => {
        gsap.registerPlugin(ScrollTrigger);
        console.log('[GSAP] ✅ ScrollTrigger registered');
        
        // Check for reduced motion
        const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
        if (prefersReducedMotion) {
          console.log('[GSAP] ⏭️ Reduced motion preferred - skipping animations');
          return;
        }
        
        // Hero animations
        const heroElements = {
          label: document.querySelector('.hero-label'),
          title: document.querySelector('.hero-title'),
          accent: document.querySelector('.hero-title-accent'),
          description: document.querySelector('.hero-description'),
          stats: document.querySelectorAll('.hero-stat'),
          cta: document.querySelector('.hero-cta-primary'),
          badge: document.querySelector('.hero-date-badge'),
          visual: document.querySelector('.hero-visual')
        };
        
        console.log('[GSAP] Hero elements found:', Object.keys(heroElements).filter(k => heroElements[k]).length);
        
        const tl = gsap.timeline({ defaults: { ease: 'power3.out' } });
        
        if (heroElements.label) tl.from('.hero-label', { opacity: 0, y: 20, duration: 0.6 });
        if (heroElements.title) tl.from('.hero-title', { opacity: 0, y: 30, duration: 0.8 }, '-=0.3');
        if (heroElements.accent) tl.from('.hero-title-accent', { opacity: 0, x: -20, duration: 0.6 }, '-=0.4');
        if (heroElements.description) tl.from('.hero-description', { opacity: 0, y: 20, duration: 0.6 }, '-=0.3');
        if (heroElements.stats.length) tl.from('.hero-stat', { opacity: 0, y: 20, stagger: 0.1, duration: 0.5 }, '-=0.2');
        if (heroElements.cta) tl.from('.hero-cta-primary', { opacity: 0, scale: 0.9, duration: 0.5, ease: 'back.out(1.7)' }, '-=0.3');
        if (heroElements.badge) tl.from('.hero-date-badge', { opacity: 0, x: -20, duration: 0.5 }, '-=0.4');
        if (heroElements.visual) gsap.from('.hero-visual', { opacity: 0, x: 50, duration: 1, ease: 'power3.out', delay: 0.3 });
        
        // Deal cards scroll animations
        const dealsSection = document.querySelector('.deals-section');
        if (dealsSection) {
          console.log('[GSAP] Setting up deals section animations');
          
          gsap.from('.deals-section .section-header-modern', {
            scrollTrigger: { trigger: '.deals-section', start: 'top 80%' },
            opacity: 0, y: 30, duration: 0.8
          });
          
          const cards = gsap.utils.toArray('.deal-wrapper');
          console.log('[GSAP] Found', cards.length, 'deal cards');
          
          if (cards.length > 0) {
            gsap.from(cards, {
              scrollTrigger: { trigger: '.deals-grid', start: 'top 85%' },
              opacity: 0, y: 40, stagger: 0.1, duration: 0.6
            });
          }
        }
        
        // Hover effects
        const dealWrappers = document.querySelectorAll('.deal-wrapper');
        console.log('[GSAP] Setting up hover effects for', dealWrappers.length, 'cards');
        
        dealWrappers.forEach(card => {
          card.addEventListener('mouseenter', () => {
            gsap.to(card, { scale: 1.03, y: -8, duration: 0.3, ease: 'power2.out' });
          });
          card.addEventListener('mouseleave', () => {
            gsap.to(card, { scale: 1, y: 0, duration: 0.3, ease: 'power2.out' });
          });
        });
        
        console.log('[GSAP] ✅ All animations initialized successfully');
      }).catch(err => {
        console.error('[GSAP] ❌ Failed to load ScrollTrigger:', err);
      });
    }).catch(err => {
      console.error('[GSAP] ❌ Failed to load GSAP:', err);
    });
  }
</script>
